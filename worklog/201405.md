**20140504**

1. 异步建立 TCP 连接，用 callback 处理错误。
  - 同步连接如果失败，会阻塞大约20秒（超时）才能获得返回值，不适合多设备批量操作。
2. 调整调用关系，不再用任务队列，读到任务后直接异步调用handler处理。
3. 帮助寻找Windows系统上的 split-horizon DNS 解决方案
  - 刘工在做的OA系统需要把一个域名根据用户的网段解析到内/外网不同的IP地址，Windows Server 2008自带的DNS服务不支持这个功能
  - 可以尝试免费软件： BIND

**20140505**

1. 对于 `设置调光模式` 类型的任务，生成一个 frame 并写到 socket
2. 把 `shared_ptr<Task>` 作为参数不断传递给 handler，完成任务后直接丢弃

**TODO**

- 发送数据的时候，可以把 `shared_ptr<Task>` 记录在 DataFrame中，写操作的 callback 函数可以根据结果更新任务的返回值和错误信息。但是收到的回复就难以与 pending tasks 准确对应上了。
- 所以现在任务的返回值只能是写操作的结果，收到的回复需要晚些时候更新。
- 也可能写成功之后，控制器返回一个失败的回复，或是没有回复，这时要设法通知前台程序。
