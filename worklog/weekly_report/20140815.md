# 本周工作记录

20140815

本周我主要工作内容如下：

* 项目方面，StarRiver服务端增添了新功能、修改了一些数据库设计。
    - 实现服务端接收任务后重启自身，绕过二部测试时遇到的Windows XP的功能限制；
    - 控制器WorkMode在初始化时增加协议以外的一个默认值0xFF供客户端区分从未查询过状态的控制器用；
    - 唐德多次反映二部目前进行测试的系统，用SrConfig初始化控制器和灯耗时很久，于是我对数据库做了一次性能测试。
        + 结果表明机房虚拟机上的MySQL（A）、我用于开发的台式机（B）和二部用于测试的笔记本（C）的**数据库性能差距非常明显**，A:B:C的处理能力大约为**8:5:2**。
        + 并且7月初做服务端性能优化时的profile数据以及这次对数据库的测试结果都表明当前这套系统的**性能瓶颈就在数据库操作**。
        + 接下来如果想要大幅提高性能，首选方案建议是提高数据库服务器的硬件配置（顺序依次为内存、硬盘、CPU）以及数据库配置文件优化。服务端程序逻辑和网络通信两项的耗时都只有15~20%左右，没有大幅改善的空间了。
    - 对于唐德反映的从调光指令返回成功，到查询出亮度变化的延迟较高的问题，我们还需要再借助日志分析原因。这项暂定在下周初执行。
* 其他杂项
    - 周三介绍了一下Redmine和Gitlab的使用入门
    - GitLab升级：v7.0.0=>v7.1.1
    - ownCloud服务器配置静态路由表，使得192.168.0.0/18、192.169.0.0/22、192.170.1.0/24、10.1.1.0/24四个网段可以访问192.168.10.200上的服务。
    - 周五发现192.168.4.36上*IE6访问不了ownCloud*，改用Firefox可以正常访问。我分析应该是IE6最长只支持128位的Key，而现在的SSL Key大多是2K和4K长。
