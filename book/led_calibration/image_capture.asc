=== Image Capture

==== gphoto2

http://gphoto.sourceforge.net/proj/[gPhoto2] is a free, redistributable, ready to use set of digital camera software applications for Unix-like systems, written by a whole team of dedicated volunteers around the world. It supports more than http://gphoto.sourceforge.net/proj/libgphoto2/support.php[1800 cameras].

Installation under Ubuntu is simple:

[source,bash]
----
apt-get install gphoto2 libgphoto2-6 libgphoto2-6-dev
----

===== (Optional) Install From Source

Optionally, you could install the latest version from source.

Install dependencies with 

[source,bash]
apt-get install -y libltdl-dev libusb-dev libexif-dev libpopt-dev libudev-dev libxml2-dev libgd-dev libcdk5-dev libreadline-dev

Then download and install `libusbx`, `libgphoto` and `gphoto2`.

[source,bash]
wget http://jaist.dl.sourceforge.net/project/libusbx/releases/1.0.18/source/libusbx-1.0.18-rc1.tar.bz2 && tar xjvf libusbx-1.0.18-rc1.tar.bz2 && cd libusbx-1.0.18-rc1 && ./configure && make && make install

[source,bash]
wget http://jaist.dl.sourceforge.net/project/gphoto/libgphoto/2.5.3.1/libgphoto2-2.5.3.1.tar.bz2 && tar xjvf libgphoto2-2.5.3.1.tar.bz2 && cd libgphoto2-2.5.3.1 && ./configure && make && make install

[source,bash]
wget http://jaist.dl.sourceforge.net/project/gphoto/gphoto/2.5.3/gphoto2-2.5.3.tar.bz2 && tar xjvf gphoto2-2.5.3.tar.bz2 && cd gphoto2-2.5.3 && ./configure && make && make install

==== Capture an Image

Before you write any code to play with the camera, I recommend checking the capabilities of your camera with `gphoto2`.

Connect your camera through USB. Unmount the device if it is automatially mounted.

Check if gphoto2 detects the camera.

[source,bash]
gphoto2 --auto-detect

You should see output like the following if `gphoto2` detected the camera.

----
Model                          Port                                            
----------------------------------------------------------
Canon EOS 7D                   usb:002,003
----

Check the capabilities of the camera.

[source,bash]
gphoto2 --summary

Here is a summary of Canon EOS 7D.

----
Camera summary:                                                                
Manufacturer: Canon Inc.
Model: Canon EOS 7D
  Version: 3-2.0.3
  Serial Number: 51b7b9f89f2244cea68db8ace79efabe
Vendor Extension ID: 0xb (2.0)

Capture Formats: JPEG
Display Formats: Association/Directory, Script, DPOF, MS AVI, MS Wave, JPEG, CRW, Unknown(b103), Unknown(bf02), Defined Type, Unknown(b104)

Device Capabilities:
	File Download, File Deletion, File Upload
	No Image Capture, No Open Capture, Canon EOS Capture, Canon EOS Shutter Button

Storage Devices Summary:
store_00010001:
	StorageDescription: CF
	VolumeLabel: None
	Storage Type: Removable RAM (memory card)
	Filesystemtype: Digital Camera Layout (DCIM)
	Access Capability: Read-Write
	Maximum Capability: 15996256256 (15255 MB)
	Free Space (Bytes): 14066253824 (13414 MB)
	Free Space (Images): -1

Device Property Summary:
Property 0xd402:(read only) (type=0xffff) 'Canon EOS 7D'
Property 0xd407:(read only) (type=0x6) 1
Property 0xd406:(readwrite) (type=0xffff) 'Unknown Initiator'
Property 0xd303:(read only) (type=0x2) 1
----

Capture an image (if the camera reported image capture support in the summary output.)

[source,bash]
gphoto2 --capture-image

The camera will focus (if not set to manual focus), take a picture and show the file locations on camera.

----
New file is in location /capt0000.jpg on the camera
New file is in location /capt0000.cr2 on the camera
----

If autofocus fails, you may see errors like

----
*** Error ***              
Canon EOS Capture failed to release: Perhaps no focus?
ERROR Could not capture image.
ERROR Could not capture.
----
